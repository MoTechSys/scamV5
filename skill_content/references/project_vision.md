# رؤية مشروع S-ACM: المتطلبات والأهداف

## 1. الهدف الاستراتيجي

تحويل S-ACM من "نظام جيد" إلى **"نظام Enterprise-Grade"** يتميز بـ:
- **مرونة مطلقة**: القدرة على إضافة أدوار جديدة (مثل "مساعد باحث" أو "مدير قسم") دون الحاجة إلى كتابة أي كود جديد، فقط من خلال لوحة التحكم.
- **أداء عالي**: ضمان استجابة سريعة للنظام حتى مع وجود عدد كبير من المستخدمين والبيانات، من خلال تحسين الاستعلامات واستخدام التخزين المؤقت (Caching).
- **أمان صارم**: تطبيق نظام صلاحيات دقيق يضمن أن كل مستخدم يمكنه الوصول فقط إلى البيانات والوظائف المسموح له بها.
- **تجربة مستخدم موحدة**: توفير واجهة مستخدم حديثة، متسقة، وسهلة الاستخدام لجميع الأدوار.

---

## 2. المتطلبات الوظيفية الرئيسية

### 2.1. واجهة موحدة تعتمد على الصلاحيات (Unified Permission-Driven UI)

- **إلغاء التقسيم الحالي**: التخلص من الواجهات المنفصلة (`/admin/`, `/instructor/`, `/student/`).
- **لوحة تحكم موحدة**: إنشاء لوحة تحكم واحدة (`/dashboard/`) تتشكل ديناميكياً بناءً على صلاحيات المستخدم.
- **قائمة جانبية ذكية**: عرض الروابط في القائمة الجانبية بناءً على صلاحيات المستخدم (`has_perm("permission_code")`) وليس دوره (`is_admin()`).

### 2.2. لوحة تحكم أدمن مخصصة (Custom Admin Panel)

- **استبدال لوحة Django الافتراضية**: إنشاء لوحة تحكم مخصصة باستخدام Bootstrap لإدارة النظام.
- **الميزات المطلوبة**:
  - **إدارة الأدوار الديناميكية**: إنشاء، تسمية، وحذف الأدوار، وتعيين الصلاحيات لكل دور باستخدام Checkboxes.
  - **إدارة المستخدمين**: إضافة، تعديل، حذف، وتفعيل المستخدمين، وتعيين الأدوار لهم.
  - **إدارة المقررات**: إدارة شاملة للمقررات الدراسية.
  - **إدارة الإعدادات**: التحكم في إعدادات النظام (مثل حجم الملفات المسموح به) من خلال واجهة رسومية.

### 2.3. نظام صلاحيات ديناميكي (Dynamic Permission System)

- **تفعيل النماذج الحالية**: استخدام نماذج `Role`, `Permission`, `RolePermission` الموجودة في قاعدة البيانات.
- **تعديل النماذج**: تحسين نموذج `Permission` ليشمل `code`, `display_name`, `category`.
- **Middleware مخصص**: إنشاء `PermissionMiddleware` لتحميل صلاحيات المستخدم في كل طلب وتوفيرها للقوالب.
- **Template Tags مخصصة**: إنشاء `{% has_perm '...' %}` للتحقق من الصلاحيات بسهولة في القوالب.

### 2.4. تحسينات الأداء والكفاءة

- **تحسين استعلامات قاعدة البيانات**: استخدام `select_related` و `prefetch_related` لتقليل عدد الاستعلامات.
- **التخزين المؤقت (Caching)**: تطبيق Caching على الصلاحيات، عناصر القائمة، والإحصائيات لزيادة سرعة الاستجابة.
- **إعادة هيكلة الكود**: اتباع مبادئ **SOLID** و **DRY** لجعل الكود أكثر قابلية للصيانة والتطوير.

---

## 3. قائمة الصلاحيات المقترحة

| الفئة | الكود | الوصف |
|---|---|---|
| **المستخدمون** | `view_user_list` | عرض قائمة المستخدمين |
| | `add_user` | إضافة مستخدم جديد |
| | `edit_user` | تعديل بيانات المستخدمين |
| | `delete_user` | حذف المستخدمين |
| **الأدوار** | `view_role_list` | عرض قائمة الأدوار |
| | `manage_roles` | إدارة الأدوار والصلاحيات |
| **المقررات** | `view_any_course` | عرض جميع المقررات في النظام |
| | `view_my_courses` | عرض المقررات الخاصة بالمستخدم فقط |
| | `add_course` | إضافة مقرر جديد |
| | `edit_course` | تعديل بيانات المقررات |
| | `delete_course` | حذف المقررات |
| **الملفات** | `upload_file` | رفع ملفات إلى المقررات |
| | `manage_files` | تعديل وحذف الملفات في المقررات |
| **الإشعارات** | `send_global_notification` | إرسال إشعار لجميع المستخدمين |
| | `send_course_notification` | إرسال إشعار لطلاب مقرر معين |
| **التقارير** | `view_system_reports` | عرض تقارير النظام الشاملة |
| | `view_personal_reports` | عرض التقارير الشخصية |
| **الإعدادات** | `manage_settings` | إدارة إعدادات النظام |
| **الذكاء الاصطناعي** | `use_ai_features` | استخدام ميزات الذكاء الاصطناعي |
