# القرارات المعمارية والتقنية لمشروع S-ACM

## 1. المكدس التقني (Tech Stack)

| الطبقة | التقنية | مبرر الاختيار |
|---|---|---|
| **الواجهة الخلفية (Backend)** | Django | إطار عمل قوي، آمن، وقابل للتطوير. يوفر ORM ممتاز، نظام مصادقة مدمج، ولوحة تحكم أدمن (التي سنستبدلها). |
| **قاعدة البيانات** | SQLite / PostgreSQL | SQLite مناسبة للتطوير لسهولتها. يوصى باستخدام PostgreSQL في بيئة الإنتاج لقوتها وأدائها. |
| **الواجهة الأمامية (Frontend)** | Bootstrap 5 | إطار عمل CSS شائع، يوفر مكونات جاهزة وتصميم متجاوب، مما يسرع عملية التطوير. |
| **التفاعلية (Interactivity)** | HTMX | مكتبة JavaScript خفيفة الوزن تسمح بإضافة تفاعلية للواجهة دون الحاجة إلى كتابة JavaScript معقد أو استخدام أطر عمل ضخمة مثل React أو Vue. |
| **الرسوم البيانية** | Chart.js | مكتبة سهلة الاستخدام لإنشاء رسوم بيانية تفاعلية، ومناسبة لعرض الإحصائيات في لوحات التحكم. |
| **المهام غير المتزامنة** | Celery + Redis | لمعالجة المهام الطويلة في الخلفية (مثل إرسال الإشعارات أو معالجة الملفات الكبيرة) دون إبطاء استجابة النظام. |
| **الذكاء الاصطناعي** | Google Gemini API | يوفر نماذج لغوية قوية لتلخيص النصوص وتوليد الأسئلة. |

---

## 2. هيكلية الواجهة الأمامية المقترحة

### المبدأ: "الواجهة الموحدة الذكية"

- **قالب أساسي واحد (`layouts/dashboard_base.html`)**: سيكون هذا القالب هو الأساس لجميع صفحات لوحات التحكم، ويحتوي على القائمة الجانبية (Sidebar) والشريط العلوي (Navbar).
- **محتوى ديناميكي**: سيتم عرض المحتوى داخل القالب الأساسي بشكل ديناميكي باستخدام `{% include %}` و `{% if %}` بناءً على صلاحيات المستخدم.
- **مكونات قابلة لإعادة الاستخدام**: سيتم تفكيك الواجهات إلى مكونات صغيرة في مجلد `templates/components/` لزيادة قابلية إعادة الاستخدام وتسهيل الصيانة.

### هيكل القوالب المقترح

```
templates/
├── base.html                          # للصفحات العامة (تسجيل دخول، أخطاء)
├── layouts/
│   └── dashboard_base.html            # القالب الموحد للوحات التحكم
├── components/                        # مكونات قابلة لإعادة الاستخدام
│   ├── sidebar.html
│   ├── stat_card.html
│   ├── course_card.html
│   └── ...
├── dashboard/                         # لوحة التحكم الموحدة
│   └── index.html
├── users/
├── roles/
├── courses/
└── ...
```

---

## 3. خطة تنفيذ إعادة الهيكلة

| المرحلة | المهمة | التفاصيل |
|---|---|---|
| **1. توحيد القوالب الأساسية** | - جعل جميع الواجهات ترث من `layouts/dashboard_base.html`.
- حذف القوالب القديمة. | 
| **2. إعادة بناء الواجهات الرئيسية** | - إعادة بناء واجهات الطالب والمدرس والمسؤول لتتوافق مع الرسومات التوضيحية.
- استخدام المكونات القابلة لإعادة الاستخدام. | 
| **3. إكمال واجهات إدارة النظام** | - بناء وتصميم واجهات إدارة المستخدمين، الأدوار، الصلاحيات، المقررات، والإعدادات. | 
| **4. ربط الواجهات بالـ Backend** | - التأكد من أن جميع الأزرار والنماذج والجداول مرتبطة بشكل صحيح بالـ Views والـ Forms. | 
| **5. المراجعة النهائية والتحسين** | - مراجعة شاملة لجميع الواجهات للتأكد من عدم وجود أي نقص.
- تحسين تجربة المستخدم. | 

---

## 4. بنية قاعدة البيانات (النماذج الرئيسية)

- **`User`**: يمثل المستخدمين (طالب، مدرس، مسؤول). سيتم تعديله ليعتمد على الأدوار والصلاحيات بدلاً من الحقول البوليانية (`is_student`, `is_instructor`).
- **`Role`**: يمثل الأدوار (مثل "مشرف"، "مدرس").
- **`Permission`**: يمثل الصلاحيات (مثل `add_user`, `delete_course`).
- **`RolePermission`**: جدول وسيط يربط الأدوار بالصلاحيات.
- **`Course`**: يمثل المقررات الدراسية.
- **`CourseFile`**: يمثل الملفات المرفوعة في كل مقرر.
- **`Notification`**: يمثل الإشعارات.
- **`AIUsageLog`**: لتتبع استخدام ميزات الذكاء الاصطناعي.

## 5. نمط التصميم (Design Pattern)

- **Model-View-Template (MVT)**: النمط القياسي في Django.
- **Fat Models, Thin Views**: سيتم وضع معظم منطق الأعمال (Business Logic) في النماذج (`models.py`) والخدمات (`services.py`)، بينما تظل الـ Views (`views.py`) خفيفة ومسؤولة فقط عن معالجة الطلبات والاستجابات.
- **Service Layer**: سيتم استخدام طبقة خدمات (`services.py`) لفصل المنطق المعقد عن الـ Views، مما يجعل الكود أكثر تنظيماً وقابلية للاختبار.
